--[[
    NIGHT CRIMSON HUB v0.1
    L√≥gica: Integrada do GitHub
    Interface: NC Custom
]]

local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local UIS = game:GetService("UserInputService")
local TS = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local TeleportService = game:GetService("TeleportService")

-- ============================================
-- CONFIGURA√á√ïES VISUAIS (NC STYLE)
-- ============================================
local MAIN_COLOR = Color3.fromRGB(40, 0, 0)
local HOVER_COLOR = Color3.fromRGB(60, 0, 0)

-- ============================================
-- VARI√ÅVEIS DE ESTADO
-- ============================================
local isFlying = false
local isFlinging = false
local isNoclipping = false
local isViewing = false
local flySpeed = 50
local targetPlayer = nil
local originalCameraType = Enum.CameraType.Custom
local originalCameraSubject = nil
local noclipConnection = nil
local flingGyro = nil

-- ============================================
-- CONSTRU√á√ÉO DA INTERFACE
-- ============================================
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "NightCrimsonHub"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Suporte para diferentes executores
if gethui then
    ScreenGui.Parent = gethui()
elseif syn and syn.protect_gui then
    syn.protect_gui(ScreenGui)
    ScreenGui.Parent = game.CoreGui
else
    ScreenGui.Parent = game.CoreGui
end

-- BOT√ÉO PRINCIPAL (NC)
local MainButton = Instance.new("TextButton")
MainButton.Name = "MainButton"
MainButton.Size = UDim2.new(0, 35, 0, 35)
MainButton.Position = UDim2.new(1, -50, 0, 20)
MainButton.AnchorPoint = Vector2.new(1, 0)
MainButton.BackgroundColor3 = MAIN_COLOR
MainButton.Text = "NC"
MainButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MainButton.Font = Enum.Font.SourceSansBold
MainButton.TextSize = 14
MainButton.ZIndex = 1000
MainButton.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(1, 0)
UICorner.Parent = MainButton

local UIStroke = Instance.new("UIStroke")
UIStroke.Color = Color3.fromRGB(0, 0, 0)
UIStroke.Thickness = 1.5
UIStroke.Parent = MainButton

-- TAG DE NOME (Fica escondida at√© o Hover)
local NameTag = Instance.new("Frame")
NameTag.Name = "NameTag"
NameTag.Size = UDim2.new(0, 0, 0, 30)
NameTag.Position = UDim2.new(1, -50, 0, 20)
NameTag.AnchorPoint = Vector2.new(1, 0)
NameTag.BackgroundColor3 = MAIN_COLOR
NameTag.BackgroundTransparency = 0.3
NameTag.Visible = false
NameTag.ZIndex = 999
NameTag.Parent = ScreenGui

local NameTagCorner = Instance.new("UICorner")
NameTagCorner.CornerRadius = UDim.new(0, 6)
NameTagCorner.Parent = NameTag

local NameLabel = Instance.new("TextLabel")
NameLabel.Size = UDim2.new(1, -10, 1, 0)
NameLabel.Position = UDim2.new(0, 5, 0, 0)
NameLabel.BackgroundTransparency = 1
NameLabel.Text = "üåë NightCrimson Hub v0.1"
NameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
NameLabel.Font = Enum.Font.SourceSansBold
NameLabel.TextSize = 12
NameLabel.TextXAlignment = Enum.TextXAlignment.Left
NameLabel.Parent = NameTag

-- BARRA DE COMANDO (Aba de digita√ß√£o)
local CommandFrame = Instance.new("Frame")
CommandFrame.Name = "CommandFrame"
CommandFrame.Size = UDim2.new(0, 0, 0, 40)
CommandFrame.Position = UDim2.new(1, -20, 1, -30)
CommandFrame.AnchorPoint = Vector2.new(1, 1)
CommandFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
CommandFrame.BackgroundTransparency = 0.15
CommandFrame.Visible = false
CommandFrame.ZIndex = 998
CommandFrame.Parent = ScreenGui

local CommandCorner = Instance.new("UICorner")
CommandCorner.CornerRadius = UDim.new(0, 8)
CommandCorner.Parent = CommandFrame

local CommandBox = Instance.new("TextBox")
CommandBox.Size = UDim2.new(1, -10, 1, 0)
CommandBox.Position = UDim2.new(0, 5, 0, 0)
CommandBox.BackgroundTransparency = 1
CommandBox.PlaceholderText = "Digite um comando..."
CommandBox.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
CommandBox.TextColor3 = Color3.fromRGB(255, 255, 255)
CommandBox.TextSize = 14
CommandBox.Font = Enum.Font.SourceSans
CommandBox.TextXAlignment = Enum.TextXAlignment.Left
CommandBox.Text = ""
CommandBox.Parent = CommandFrame

-- ============================================
-- SISTEMA DE ARRASTAR (MOBILE & PC)
-- ============================================
local dragging, dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    local newPos = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    MainButton.Position = newPos
    NameTag.Position = newPos
end

MainButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = MainButton.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

MainButton.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UIS.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)
-- ============================================
-- SISTEMA DE FUN√á√ïES (L√ìGICA DO GITHUB)
-- ============================================

-- Fun√ß√£o: ENCONTRAR JOGADOR (Busca por nome ou DisplayName)
local function findPlayerByName(name)
    name = name:lower():gsub("%s+$", "")
    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= Player and (p.Name:lower():find(name) or p.DisplayName:lower():find(name)) then
            return p
        end
    end
    return nil
end

-- Fun√ß√£o: FLY (Voo Estilo Ryuzen)
local function toggleFly(speed)
    local char = Player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end
    local torso = char.HumanoidRootPart
    local hum = char:FindFirstChildOfClass("Humanoid")

    if isFlying then
        isFlying = false
        if hum then hum.PlatformStand = false end
        for _, v in pairs(torso:GetChildren()) do
            if v:IsA("BodyGyro") or v:IsA("BodyVelocity") then v:Destroy() end
        end
    else
        isFlying = true
        flySpeed = tonumber(speed) or 50
        if hum then hum.PlatformStand = true end
        
        local bg = Instance.new("BodyGyro", torso)
        bg.P = 9e4
        bg.maxTorque = Vector3.new(9e9, 9e9, 9e9)
        bg.cframe = torso.CFrame
        
        local bv = Instance.new("BodyVelocity", torso)
        bv.velocity = Vector3.new(0, 0, 0)
        bv.maxForce = Vector3.new(9e9, 9e9, 9e9)
        
        task.spawn(function()
            while isFlying and torso.Parent do
                RunService.RenderStepped:Wait()
                bv.velocity = Workspace.CurrentCamera.CFrame.LookVector * flySpeed
                bg.cframe = Workspace.CurrentCamera.CFrame
            end
        end)
    end
end

-- Fun√ß√£o: NOCLIP (Atravessar Paredes)
local function toggleNoclip()
    isNoclipping = not isNoclipping
    if isNoclipping then
        noclipConnection = RunService.Stepped:Connect(function()
            if not isNoclipping or not Player.Character then 
                if noclipConnection then noclipConnection:Disconnect() end
                return 
            end
            for _, part in pairs(Player.Character:GetDescendants()) do
                if part:IsA("BasePart") then part.CanCollide = false end
            end
        end)
    else
        if noclipConnection then noclipConnection:Disconnect() end
    end
end

-- Fun√ß√£o: VIEW (Observar Jogador)
local function toggleView(target)
    if target then
        isViewing = true
        Workspace.CurrentCamera.CameraSubject = target.Character:FindFirstChild("Humanoid")
    else
        isViewing = false
        Workspace.CurrentCamera.CameraSubject = Player.Character:FindFirstChild("Humanoid")
    end
end

-- Fun√ß√£o: SPEED e JUMP
local function setStats(type, val)
    local hum = Player.Character and Player.Character:FindFirstChildOfClass("Humanoid")
    if hum then
        if type == "speed" then hum.WalkSpeed = tonumber(val) or 16
        elseif type == "jump" then hum.JumpPower = tonumber(val) or 50 end
    end
end

-- Fun√ß√£o: FLING (Girar para empurrar)
local function toggleFling()
    local hrp = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    
    isFlinging = not isFlinging
    if isFlinging then
        flingGyro = Instance.new("BodyAngularVelocity", hrp)
        flingGyro.MaxTorque = Vector3.new(0, math.huge, 0)
        flingGyro.AngularVelocity = Vector3.new(0, 99999, 0)
        flingGyro.Name = "NC_Fling"
    else
        if hrp:FindFirstChild("NC_Fling") then hrp.NC_Fling:Destroy() end
    end
end

-- Fun√ß√£o: REJOIN e SERVER HOP
local function serverAction(type)
    if type == "rj" then
        TeleportService:Teleport(game.PlaceId, Player)
    elseif type == "sh" then
        -- L√≥gica b√°sica de Server Hop
        print("Procurando novo servidor...")
    end
end
-- ============================================
-- 3. PROCESSADOR DE COMANDOS
-- ============================================

local function executeCommand(input)
    if not input or input == "" then return end
    
    local args = string.split(input:lower(), " ")
    local cmd = args[1]
    
    -- L√≥gica de decis√£o de comandos
    if cmd == "fly" then
        toggleFly(args[2])
    elseif cmd == "unfly" then
        if isFlying then toggleFly() end
        
    elseif cmd == "noclip" then
        toggleNoclip()
    elseif cmd == "unnoclip" then
        if isNoclipping then toggleNoclip() end
        
    elseif cmd == "speed" then
        setStats("speed", args[2])
    elseif cmd == "unspeed" then
        setStats("speed", 16)
        
    elseif cmd == "jump" then
        setStats("jump", args[2])
    elseif cmd == "unjump" then
        setStats("jump", 50)
        
    elseif cmd == "view" then
        local target = findPlayerByName(args[2] or "")
        if target then toggleView(target) end
    elseif cmd == "unview" then
        toggleView(nil)
        
    elseif cmd == "fling" then
        toggleFling()
    elseif cmd == "unfling" then
        if isFlinging then toggleFling() end
        
    elseif cmd == "goto" then
        local target = findPlayerByName(args[2] or "")
        if target and target.Character then
            local hrp = Player.Character:FindFirstChild("HumanoidRootPart")
            local targetHrp = target.Character:FindFirstChild("HumanoidRootPart")
            if hrp and targetHrp then
                hrp.CFrame = targetHrp.CFrame * CFrame.new(0, 0, 3)
            end
        end
        
    elseif cmd == "rejoin" or cmd == "rj" then
        serverAction("rj")
    elseif cmd == "sh" or cmd == "serverhop" then
        serverAction("sh")
    end
    
    CommandBox.Text = "" -- Limpa a caixa ap√≥s executar
end

-- ============================================
-- 4. CONTROLE DA INTERFACE (ANIMA√á√ïES)
-- ============================================

local function openCommandBar()
    CommandFrame.Visible = true
    MainButton.Text = "üåë" -- Muda o √≠cone enquanto a aba est√° aberta
    
    -- Anima√ß√£o de Entrada
    TS:Create(CommandFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Size = UDim2.new(0, 300, 0, 40),
        Position = UDim2.new(1, -320, 1, -60)
    }):Play()
    
    task.wait(0.1)
    CommandBox:CaptureFocus()
end

local function closeCommandBar()
    -- Anima√ß√£o de Sa√≠da
    local tween = TS:Create(CommandFrame, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
        Size = UDim2.new(0, 0, 0, 40),
        Position = UDim2.new(1, -20, 1, -30)
    })
    
    tween:Play()
    tween.Completed:Connect(function()
        CommandFrame.Visible = false
        MainButton.Text = "NC" -- Volta para o texto padr√£o
    end)
end

-- ============================================
-- 5. EVENTOS DE INTERA√á√ÉO
-- ============================================

-- Clique no bot√£o NC
MainButton.MouseButton1Click:Connect(function()
    if CommandFrame.Visible then
        closeCommandBar()
    else
        openCommandBar()
    end
end)

-- Hover (Passar o mouse) mostra a Tag
MainButton.MouseEnter:Connect(function()
    NameTag.Visible = true
    TS:Create(NameTag, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Size = UDim2.new(0, 165, 0, 30),
        Position = UDim2.new(1, -170, 0, 20)
    }):Play()
end)

MainButton.MouseLeave:Connect(function()
    TS:Create(NameTag, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
        Size = UDim2.new(0, 0, 0, 30),
        Position = UDim2.new(1, -50, 0, 20)
    }):Play()
    task.wait(0.2)
    NameTag.Visible = false
end)

-- Processar quando apertar Enter
CommandBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        executeCommand(CommandBox.Text)
    end
    
    -- Auto-fechar se perder o foco e estiver vazio
    task.wait(0.5)
    if not CommandBox:IsFocused() and CommandBox.Text == "" then
        closeCommandBar()
    end
end)

-- Inicializa√ß√£o
print("üåë NightCrimson Hub v0.1 carregado com sucesso!")
